### FormalPowerSeries
- 形式的冪級数、多項式ライブラリ
- 具体的には下記の係数$a=(a_0,...a_{n-1})$を保持するクラス
  - $f(x)=a_0 + a_1x^1 + a_2x^2 + ... + a_{n-1}x^{n-1}$

- 以下FormalPowerSeriesの型のことを`Fps`と称す。
- 0-indexed
  - `Fps f(N)`で初期化した場合は`N-1`項までが確保される
- `ModInt`あるいは`RuntimeModInt`をテンプレートで渡す必要がある
  - [RuntimeModIntのときの使い方はこの提出を参考](https://atcoder.jp/contests/abc137/submissions/21563722)
- 実装はvectorを継承しているので、`[]`演算子などが使える。
- ntt-friendlyでないmod(1000'000'007など)でも対応。使い方は同じ。
  - 内部でgarnerを使うかどうかを制御している。
- 実行時modにも対応。使い方は同じ。

### コンストラクタ
- 基本的にはvectorに同じ
- FormalPowerSeries(vector< Mint > v)
  - ModInt型のvectorでも初期化できる
  
### メソッド
- int,long long,ModInt型に対して、Fpsとの四則演算をオーバーロードしている。
  - 演算は、fpsの各項に対して行われる。
  - +,-,*: $O(N)$
  - /: $O(N+\log mod)$
- Fps prefix(size_t n)
  - Fpsのprefix
  - $O(n)$
  - Fpsの`0`項目から`n-1`項目までのコピーが返却される
- Fps inv(size_t n)
  - Fpsの逆元$1/(f(x))$を返却する
  - $O(N\log N)$
  - nは打ち切りたい項数。指定しなかった場合は今のFpsと同じ大きさで返却される
- Fps diff(void) 
  - 微分$\( f'(x) \)$を返却する
  - $O(N)$
- Fps intg(void) 
  - 積分$\( \int f(x)dx \)$を返却する
  - $O(N)$
  - 初回時だけ、$O(N+\log mod)$
- Fps log(size_t n)
  - 対数$\log f(x)$を返却する
  - $O(NlogN)$
  - nは打ち切りたい項数。指定しなかった場合は今のFpsと同じ大きさで返却される
- Fps exp(size_t n) 
  - 指数$\exp f(x)$を返却する
  - $O(N\log N)$
  - nは打ち切りたい項数。指定しなかった場合は今のFpsと同じ大きさで返却される
- Fps pow(long long k,size_t n) 
  - 累乗$ f(x)^k$を返却する
  - $O(N\log N)$
  - nは打ち切りたい項数。指定しなかった場合は今のFps.size()*kの大きさで返却される
- Mint eval(Mint x)
  - 一点評価
  - f(x)を返す
  - $O(N)$
- Fps add(const Fps& lhs,const Fps& rhs) 
  - 2個のfpsの各要素の和を取ったfpsを返却する。
  - $O(N)$
  - サイズは、lhs,rhsの大きい方に合わせる。
- Fps sub(const Fps& lhs,const Fps& rhs) 
  - 2個のfpsの各要素の差を取ったfpsを返却する。
  - lhs[i]-rhs[i]が返ると思って良い
  - $O(N)$
  - サイズは、lhs,rhsの大きい方に合わせる。
- Fps mul(const Fps& lhs,const Fps& rhs) 
  - 2個のfpsを畳み込んだfpsを返却する。
  - 内部的にはnttを使用
  - $O(N\log N)$
  - サイズは、lhs.size()+rhs.size()-1になる。
- Fps div(const Fps& lhs,const Fps& rhs) 
  - lhsをrhsで割ったfpsを返却する。
  - lhs * rhs.inv() とは違うことに注意。単純な多項式除算である。
  - $O(N\log N)$
  - サイズは、lhs.size()-rhs.size()+1になる。
  - [提出](https://atcoder.jp/contests/abc245/submissions/41991428)
- Fps mod(const Fps& lhs,const Fps& rhs) 
  - lhsをrhsで割ったあまりのfpsを返却する。
  - 単純な多項式除算から発生する余りであることに注意。
  - $O(N\log N)$
  - サイズは、rhs.size()-1になる
- Fps fold_all(vector<Fps> vfps, size_t n=0)
  - 複数個のfpsをマージテクを使って積を取る
  - nを指定すると、そのprefixで打ち切りながら積を取る
  - [提出](https://atcoder.jp/contests/tdpc/submissions/41600573)
  - [提出](https://atcoder.jp/contests/abc169/submissions/42001325)
- vector<Mint> multipoint_evaluation(vector<Mint> x)
  - 多点評価
  - f(x_0),f(x_1), ... , f(x_N) が返る
  - $O(N\log N)$ 定数倍重め。
- inline static Fps interpolation(const vector<Mint>& x,const vector<Mint>& y) 
  - 多項式補間
  - f(x_0)=y_0,f(x_1)=y_1, ... , f(x_N)=y_N を満たすfpsが返る
  - $O(N\log N)$ 定数倍重め。
- Mint nth_term(long long n,const Fps& numerator,const Fps& denominator)
  - f(x)のn項目が返却される
  - $O(N\log N \log n)$
  - nは求めたい項数 
  - numeratorは分子のFps (numerator=1かつ求めたい項が大きくないなら、invを使う方が速い)
  - denominatorは分母のFps
  - [提出](https://atcoder.jp/contests/abc178/submissions/41992411)
  - [提出](https://atcoder.jp/contests/abc179/submissions/41995344)

### 参考資料
- [【競技プログラミング】形式的冪級数の応用テクニック(前編)](https://qiita.com/hotman78/items/f0e6d2265badd84d429a)
- [形式的冪級数(Formal-Power-Series) / Luzhiled’s memo](https://ei1333.github.io/luzhiled/snippets/math/formal-power-series.html)
- [形式的べき級数解説 / maspyのHP](https://maspypy.com/category/%e5%bd%a2%e5%bc%8f%e7%9a%84%e3%81%b9%e3%81%8d%e7%b4%9a%e6%95%b0%e8%a7%a3%e8%aa%ac)
- [(形式的)べき級数と数え上げの写像12相との関係性　前編 - Senの競技プログラミング備忘録](https://sen-comp.hatenablog.com/entry/2019/12/07/142131)
- [今年中に理解する！多項式、母関数、形式的べき級数の競プロでの実践的使い方 - はまやんはまやんはまやん](https://www.hamayanhamayan.com/entry/2019/12/07/000441)
- [線形漸化式を満たす数列の N 項目を計算するアルゴリズム](http://q.c.titech.ac.jp/docs/progs/polynomial_division.html)
- [形式的冪級数（FPS）の inv，log，exp，pow の定数倍の軽いアルゴリズム](https://opt-cp.com/fps-fast-algorithms/)
- [多項式を使うテクニックたち](https://yukicoder.me/wiki/polynomial_techniques)
- [非再帰で多項式の多点評価をするよ](https://rsk0315.hatenablog.com/entry/2020/04/05/190941)
- [非再帰で補間多項式を求めるよ](https://rsk0315.hatenablog.com/entry/2020/04/05/203210)
- 桁dpもできる
  - [[多項式・形式的べき級数]（２）式変形による解法の導出](https://maspypy.com/%e5%a4%9a%e9%a0%85%e5%bc%8f%e3%83%bb%e5%bd%a2%e5%bc%8f%e7%9a%84%e3%81%b9%e3%81%8d%e7%b4%9a%e6%95%b0%ef%bc%88%ef%bc%92%ef%bc%89%e5%bc%8f%e5%a4%89%e5%bd%a2%e3%81%ab%e3%82%88%e3%82%8b%e8%a7%a3%e6%b3%95)
  - [提出](https://atcoder.jp/contests/abc135/submissions/42000622)
- $(1-rx)^(-K) = Σ (n+K-1)_C_(K-1) (rx)^n$
  - [[AtCoder 参加感想] 2020/06/21:ABC 171](https://maspypy.com/atcoder-%e5%8f%82%e5%8a%a0%e6%84%9f%e6%83%b3-2020-06-21abc-17#toc4)
  - [提出](https://atcoder.jp/contests/abc171/submissions/42004091)